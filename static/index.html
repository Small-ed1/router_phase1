<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ollama Web</title>
  <link rel="stylesheet" href="/static/styles.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" id="prismTheme" />
</head>
<body>
  <div id="sidebarOverlay" class="sidebarOverlay hidden"></div>

  <aside id="sidebar" class="sidebar closed">
    <div class="sidebarTop">
      <div class="sidebarBrand">Ollama Web</div>
      <button id="btnSidebarClose" class="iconbtn" aria-label="Close sidebar">‚úï</button>
    </div>

    <div class="sidebarTabs">
      <button id="tabChats" class="tab active" aria-label="Chats tab">Chats</button>
      <button id="tabDocs" class="tab" aria-label="Docs tab">Docs</button>
      <button id="tabSettings" class="tab" aria-label="Settings tab">Settings</button>
    </div>

    <!-- CHATS -->
    <div id="panelChats" class="sidebarPanel">
      <div class="row">
        <button id="btnNewChat" class="btn" aria-label="New chat">+ New</button>
        <label class="pill">
          <input type="checkbox" id="showArchived" />
          <span>Archived</span>
        </label>
      </div>

      <input id="chatSearch" class="input" placeholder="Search chats..." aria-label="Search chats" />

      <div id="chatList" class="chatList"></div>

      <div class="row" style="justify-content:space-between;">
        <div class="export-dropdown">
          <button id="btnExportChat" class="btn" aria-label="Export current chat">Export ‚ñº</button>
          <div class="export-menu hidden">
            <button class="export-option" data-format="markdown">Markdown</button>
            <button class="export-option" data-format="json">JSON</button>
            <button class="export-option" data-format="txt">Plain Text</button>
          </div>
        </div>
        <button id="btnClear" class="btn" aria-label="Clear chat">üßπ Clear</button>
      </div>
    </div>

    <!-- DOCS -->
    <div id="panelDocs" class="sidebarPanel hidden">
      <div class="field">
        <div class="label">Upload document</div>
        <input id="fileUpload" type="file" class="input" aria-label="Upload doc"/>
        <div class="hint">Text files work best. PDFs/Docx require extraction support (not included).</div>
      </div>

      <div class="row" style="justify-content:space-between;align-items:center;">
        <div class="label" style="margin:0;">Active docs</div>
        <button id="btnDocsAll" class="btn" aria-label="Select all docs">All</button>
        <button id="btnDocsNone" class="btn" aria-label="Select no docs">None</button>
      </div>

      <div id="docsList" class="docsList"></div>
    </div>

    <!-- SETTINGS -->
    <div id="panelSettings" class="sidebarPanel hidden">
      <div class="field">
        <div class="label">Preset</div>
        <select id="presetSelect" class="select" aria-label="Preset"></select>
        <div class="hint">Presets set model + temperature + context + RAG defaults.</div>
      </div>

      <div class="field">
        <div class="label">System prompt</div>
        <textarea id="systemPrompt" class="textarea" rows="4" aria-label="System prompt"></textarea>
      </div>

      <div class="grid2">
        <div class="field">
          <div class="label">Temperature</div>
          <input id="temperature" type="number" step="0.05" min="0" max="2" class="input" aria-label="Temperature" />
        </div>

        <div class="field">
          <div class="label">Context (num_ctx)</div>
          <input id="numCtx" type="number" step="256" min="512" class="input" aria-label="Context size" />
        </div>
      </div>

      <div class="grid2">
        <div class="field">
          <div class="label">RAG Top K</div>
          <input id="topK" type="number" min="1" max="20" value="6" class="input" aria-label="Top K"/>
        </div>

        <div class="field">
          <div class="label">MMR (diversify)</div>
          <label class="pill" style="width:fit-content;">
            <input type="checkbox" id="mmrToggle" />
            <span>On</span>
          </label>
        </div>
      </div>

      <div class="field">
        <div class="label">Keep alive</div>
        <input id="keepAlive" class="input" placeholder="5m" aria-label="Keep alive" />
        <div class="hint">Example: 0, 5m, 30m</div>
      </div>

      <div class="field">
        <label class="pill" style="width:fit-content;">
          <input type="checkbox" id="autoModelToggle" aria-label="Auto-pick best model for this prompt" />
          <span>Auto model</span>
        </label>
      </div>

      <div class="row">
        <button id="btnSaveSettings" class="btn primary" aria-label="Save settings">Save</button>
        <button id="btnResetSettings" class="btn" aria-label="Reset settings">Reset</button>
      </div>
    </div>
  </aside>

  <div class="app">
    <header class="topbar">
      <div class="brand">
        <div class="logo">‚óé</div>
        <div class="titles">
          <div class="title">Ollama Web</div>
          <div class="subtitle">
            <span id="statusDot" class="dot"></span>
            <span id="statusText">Checking Ollama‚Ä¶</span>
            <span id="ragSummary" class="badge" title="Active docs for this chat">RAG: off</span>
          </div>
        </div>
      </div>

      <div class="controls">
        <button id="btnSidebar" class="btn" aria-label="Open sidebar">‚ò∞</button>
        
        <button id="btnTheme" class="iconbtn" aria-label="Toggle theme">‚óê</button>
        
        <button id="btnHelp" class="iconbtn" aria-label="Keyboard shortcuts">?</button>
        
        <label class="pill" style="gap:8px;">
          <input type="checkbox" id="ragToggle" />
          <span>RAG</span>
        </label> 
        
        <select id="modelSelect" class="select" aria-label="Model"></select> 
        
        <button id="btnStop" class="btn danger hidden" aria-label="Stop generation">‚ñ† Stop</button>
      </div>
    </header>

    <main class="main">
      <div id="chat" class="chat" aria-live="polite"></div>
      <button id="scrollToBottomBtn" class="scroll-to-bottom-btn" title="Scroll to bottom">
        <span>‚Üì</span>
        <span class="scroll-count" id="scrollCount" style="display:none;"></span>
      </button>
      <div id="scrollHint" class="scroll-hint hidden">New messages ‚Üì</div>
    </main>

    <footer class="composer">
      <button id="btnEditLast" class="btn" aria-label="Edit last user message">‚úé Edit</button>

      <div id="slashPalette" class="slashPalette hidden" role="listbox" aria-label="Slash commands"></div>

      <textarea
        id="prompt"
        class="input"
        rows="1"
        aria-label="Chat prompt"
        placeholder="Type a message‚Ä¶ (Ctrl+Enter to send)"
      ></textarea>

      <button id="btnSend" class="btn primary" aria-label="Send (Ctrl+Enter)">Send</button>
    </footer>
  </div>

  <!-- SOURCES MODAL -->
  <div id="modalOverlay" class="modalOverlay hidden"></div>
  <div id="modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Source viewer">
    <div class="modalHead">
      <div id="modalTitle" class="modalTitle">Source</div>
      <button id="btnModalClose" class="iconbtn" aria-label="Close">‚úï</button>
    </div>
    <div id="modalBody" class="modalBody"></div>
  </div>

  <!-- KEYBOARD SHORTCUTS MODAL -->
  <div id="shortcutsOverlay" class="modalOverlay hidden"></div>
  <div id="shortcutsModal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Keyboard shortcuts">
    <div class="modalHead">
      <div class="modalTitle">Keyboard Shortcuts</div>
      <button id="btnShortcutsClose" class="iconbtn" aria-label="Close">‚úï</button>
    </div>
    <div class="modalBody shortcutsList">
      <div class="shortcutItem"><span class="shortcutKey">Ctrl+Enter</span> <span class="shortcutDesc">Send message</span></div>
      <div class="shortcutItem"><span class="shortcutKey">Ctrl+K</span> <span class="shortcutDesc">Clear chat</span></div>
      <div class="shortcutItem"><span class="shortcutKey">Ctrl+N</span> <span class="shortcutDesc">New chat</span></div>
      <div class="shortcutItem"><span class="shortcutKey">Ctrl+/</span> <span class="shortcutDesc">Show shortcuts</span></div>
      <div class="shortcutItem"><span class="shortcutKey">Escape</span> <span class="shortcutDesc">Stop generation</span></div>
      <div class="shortcutItem"><span class="shortcutKey">Ctrl+E</span> <span class="shortcutDesc">Edit last message</span></div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="/static/app.js"></script>
</body>
</html>