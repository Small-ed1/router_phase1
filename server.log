INFO:     Will watch for changes in these directories: ['/home/small_ed/router_phase1']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [820402] using WatchFiles
INFO:     Started server process [820477]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
2026-01-12 07:12:38,072 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/tags "HTTP/1.1 200 OK"
INFO:     127.0.0.1:55576 - "POST /api/chat HTTP/1.1" 400 Bad Request
2026-01-12 07:12:42,955 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/version "HTTP/1.1 200 OK"
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
2026-01-12 07:12:42,970 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/tags "HTTP/1.1 200 OK"
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET / HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /static/styles.css HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /static/app.js HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/chats?archived=0 HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/chats/7fc907d2-42d4-4242-a23a-7e78153807bf HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /favicon.ico HTTP/1.1" 404 Not Found
INFO:     100.89.145.6:0 - "GET /api/chats/7fc907d2-42d4-4242-a23a-7e78153807bf/prefs HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/chats?archived=0 HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/docs HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/slash_commands HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
2026-01-12 07:13:15,957 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/tags "HTTP/1.1 200 OK"
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET / HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/chats?archived=0 HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/chats/7fc907d2-42d4-4242-a23a-7e78153807bf HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/chats/7fc907d2-42d4-4242-a23a-7e78153807bf/prefs HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/chats?archived=0 HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/docs HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/slash_commands HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "POST /api/chats/7fc907d2-42d4-4242-a23a-7e78153807bf/append HTTP/1.1" 200 OK
2026-01-12 07:13:28,247 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/tags "HTTP/1.1 200 OK"
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "POST /api/decide_model HTTP/1.1" 200 OK
2026-01-12 07:13:48,267 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/tags "HTTP/1.1 200 OK"
INFO:     100.89.145.6:0 - "POST /api/chat HTTP/1.1" 200 OK
2026-01-12 07:13:48,277 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/embed "HTTP/1.1 404 Not Found"
ERROR:    Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "/usr/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/usr/lib/python3.13/site-packages/starlette/responses.py", line 270, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/home/small_ed/.local/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 783, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/usr/lib/python3.13/site-packages/uvicorn/protocols/http/httptools_impl.py", line 416, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "/usr/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/usr/lib/python3.13/site-packages/fastapi/applications.py", line 1135, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/usr/lib/python3.13/site-packages/starlette/applications.py", line 107, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/usr/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/usr/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/usr/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/usr/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/usr/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/usr/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/usr/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/usr/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/usr/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/usr/lib/python3.13/site-packages/fastapi/routing.py", line 115, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/usr/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/usr/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/usr/lib/python3.13/site-packages/fastapi/routing.py", line 102, in app
    |     await response(scope, receive, send)
    |   File "/usr/lib/python3.13/site-packages/starlette/responses.py", line 269, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "/usr/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/usr/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/usr/lib/python3.13/site-packages/starlette/responses.py", line 273, in wrap
    |     await func()
    |   File "/usr/lib/python3.13/site-packages/starlette/responses.py", line 253, in stream_response
    |     async for chunk in self.body_iterator:
    |     ...<2 lines>...
    |         await send({"type": "http.response.body", "body": chunk, "more_body": True})
    |   File "/home/small_ed/router_phase1/app.py", line 803, in stream
    |     sources = await ragstore.retrieve(
    |               ^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<6 lines>...
    |     )
    |     ^
    |   File "/home/small_ed/router_phase1/ragstore.py", line 524, in retrieve
    |     qv = (await embed_texts([query], embed_model))[0]
    |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/small_ed/router_phase1/ragstore.py", line 168, in embed_texts
    |     r.raise_for_status()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "/home/small_ed/.local/lib/python3.13/site-packages/httpx/_models.py", line 829, in raise_for_status
    |     raise HTTPStatusError(message, request=request, response=self)
    | httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://127.0.0.1:11434/api/embed'
    | For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.13/site-packages/uvicorn/protocols/http/httptools_impl.py", line 416, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/usr/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.13/site-packages/fastapi/applications.py", line 1135, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/lib/python3.13/site-packages/starlette/applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/usr/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/usr/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/usr/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/usr/lib/python3.13/site-packages/fastapi/routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/usr/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/lib/python3.13/site-packages/fastapi/routing.py", line 102, in app
    await response(scope, receive, send)
  File "/usr/lib/python3.13/site-packages/starlette/responses.py", line 269, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/usr/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/usr/lib/python3.13/site-packages/starlette/responses.py", line 273, in wrap
    await func()
  File "/usr/lib/python3.13/site-packages/starlette/responses.py", line 253, in stream_response
    async for chunk in self.body_iterator:
    ...<2 lines>...
        await send({"type": "http.response.body", "body": chunk, "more_body": True})
  File "/home/small_ed/router_phase1/app.py", line 803, in stream
    sources = await ragstore.retrieve(
              ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/home/small_ed/router_phase1/ragstore.py", line 524, in retrieve
    qv = (await embed_texts([query], embed_model))[0]
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/small_ed/router_phase1/ragstore.py", line 168, in embed_texts
    r.raise_for_status()
    ~~~~~~~~~~~~~~~~~~^^
  File "/home/small_ed/.local/lib/python3.13/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://127.0.0.1:11434/api/embed'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
INFO:     100.89.145.6:0 - "POST /api/chats/7fc907d2-42d4-4242-a23a-7e78153807bf/append HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/chats?archived=0 HTTP/1.1" 200 OK
2026-01-12 07:13:54,825 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/version "HTTP/1.1 200 OK"
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
2026-01-12 07:13:54,839 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/tags "HTTP/1.1 200 OK"
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
INFO:     127.0.0.1:34088 - "GET /health HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
2026-01-12 07:14:22,633 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/tags "HTTP/1.1 200 OK"
INFO:     127.0.0.1:34094 - "POST /api/chat HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
2026-01-12 07:14:30,961 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/tags "HTTP/1.1 200 OK"
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET / HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /static/app.js HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/chats?archived=0 HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/chats/7fc907d2-42d4-4242-a23a-7e78153807bf HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/chats/7fc907d2-42d4-4242-a23a-7e78153807bf/prefs HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/chats?archived=0 HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/docs HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/slash_commands HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
2026-01-12 07:14:57,219 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/tags "HTTP/1.1 200 OK"
INFO:     127.0.0.1:57066 - "POST /api/chat HTTP/1.1" 200 OK
2026-01-12 07:15:00,430 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/version "HTTP/1.1 200 OK"
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
2026-01-12 07:15:12,449 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/tags "HTTP/1.1 200 OK"
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
2026-01-12 07:15:48,431 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/tags "HTTP/1.1 200 OK"
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET / HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /static/styles.css HTTP/1.1" 304 Not Modified
INFO:     100.89.145.6:0 - "GET /static/app.js HTTP/1.1" 304 Not Modified
INFO:     100.89.145.6:0 - "GET /api/chats?archived=0 HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/chats/7fc907d2-42d4-4242-a23a-7e78153807bf HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/chats/7fc907d2-42d4-4242-a23a-7e78153807bf/prefs HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/chats?archived=0 HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/docs HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/slash_commands HTTP/1.1" 200 OK
2026-01-12 07:16:09,508 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/version "HTTP/1.1 200 OK"
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "POST /api/chats/7fc907d2-42d4-4242-a23a-7e78153807bf/append HTTP/1.1" 200 OK
2026-01-12 07:16:20,811 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/tags "HTTP/1.1 200 OK"
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
2026-01-12 07:16:21,515 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/tags "HTTP/1.1 200 OK"
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
2026-01-12 07:16:32,482 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
INFO:     100.89.145.6:0 - "POST /api/decide_model HTTP/1.1" 200 OK
2026-01-12 07:16:32,500 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/tags "HTTP/1.1 200 OK"
INFO:     100.89.145.6:0 - "POST /api/chat HTTP/1.1" 200 OK
2026-01-12 07:16:32,503 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/embed "HTTP/1.1 404 Not Found"
ERROR:    Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "/usr/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/usr/lib/python3.13/site-packages/starlette/responses.py", line 270, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/home/small_ed/.local/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 783, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/usr/lib/python3.13/site-packages/uvicorn/protocols/http/httptools_impl.py", line 416, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "/usr/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/usr/lib/python3.13/site-packages/fastapi/applications.py", line 1135, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/usr/lib/python3.13/site-packages/starlette/applications.py", line 107, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/usr/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/usr/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/usr/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/usr/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/usr/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/usr/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/usr/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/usr/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/usr/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/usr/lib/python3.13/site-packages/fastapi/routing.py", line 115, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/usr/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/usr/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/usr/lib/python3.13/site-packages/fastapi/routing.py", line 102, in app
    |     await response(scope, receive, send)
    |   File "/usr/lib/python3.13/site-packages/starlette/responses.py", line 269, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "/usr/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/usr/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/usr/lib/python3.13/site-packages/starlette/responses.py", line 273, in wrap
    |     await func()
    |   File "/usr/lib/python3.13/site-packages/starlette/responses.py", line 253, in stream_response
    |     async for chunk in self.body_iterator:
    |     ...<2 lines>...
    |         await send({"type": "http.response.body", "body": chunk, "more_body": True})
    |   File "/home/small_ed/router_phase1/app.py", line 803, in stream
    |     sources = await ragstore.retrieve(
    |               ^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<6 lines>...
    |     )
    |     ^
    |   File "/home/small_ed/router_phase1/ragstore.py", line 524, in retrieve
    |     qv = (await embed_texts([query], embed_model))[0]
    |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/small_ed/router_phase1/ragstore.py", line 168, in embed_texts
    |     r.raise_for_status()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "/home/small_ed/.local/lib/python3.13/site-packages/httpx/_models.py", line 829, in raise_for_status
    |     raise HTTPStatusError(message, request=request, response=self)
    | httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://127.0.0.1:11434/api/embed'
    | For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.13/site-packages/uvicorn/protocols/http/httptools_impl.py", line 416, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/usr/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.13/site-packages/fastapi/applications.py", line 1135, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/lib/python3.13/site-packages/starlette/applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/usr/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/usr/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/usr/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/usr/lib/python3.13/site-packages/fastapi/routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/usr/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/lib/python3.13/site-packages/fastapi/routing.py", line 102, in app
    await response(scope, receive, send)
  File "/usr/lib/python3.13/site-packages/starlette/responses.py", line 269, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/usr/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/usr/lib/python3.13/site-packages/starlette/responses.py", line 273, in wrap
    await func()
  File "/usr/lib/python3.13/site-packages/starlette/responses.py", line 253, in stream_response
    async for chunk in self.body_iterator:
    ...<2 lines>...
        await send({"type": "http.response.body", "body": chunk, "more_body": True})
  File "/home/small_ed/router_phase1/app.py", line 803, in stream
    sources = await ragstore.retrieve(
              ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/home/small_ed/router_phase1/ragstore.py", line 524, in retrieve
    qv = (await embed_texts([query], embed_model))[0]
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/small_ed/router_phase1/ragstore.py", line 168, in embed_texts
    r.raise_for_status()
    ~~~~~~~~~~~~~~~~~~^^
  File "/home/small_ed/.local/lib/python3.13/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://127.0.0.1:11434/api/embed'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
INFO:     100.89.145.6:0 - "POST /api/chats/7fc907d2-42d4-4242-a23a-7e78153807bf/append HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/chats?archived=0 HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
2026-01-12 07:16:57,957 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/tags "HTTP/1.1 200 OK"
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
2026-01-12 07:17:09,961 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/version "HTTP/1.1 200 OK"
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
2026-01-12 07:17:33,966 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/tags "HTTP/1.1 200 OK"
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/status HTTP/1.1" 200 OK
INFO:     100.89.145.6:0 - "GET /api/models HTTP/1.1" 200 OK
