{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://cognihub.local/schemas/tool_contract.json",
  "title": "CogniHub Tool Contract",
  "oneOf": [
    { "$ref": "#/$defs/ToolRequest" },
    { "$ref": "#/$defs/FinalAnswer" }
  ],
  "$defs": {
    "ToolCall": {
      "type": "object",
      "required": ["id", "name", "arguments"],
      "additionalProperties": false,
      "properties": {
        "id": { "type": "string", "minLength": 1, "maxLength": 64 },
        "name": { "type": "string", "minLength": 1, "maxLength": 64 },
        "arguments": { "type": "object" }
      }
    },
    "ToolRequest": {
      "type": "object",
      "required": ["type", "id", "tool_calls"],
      "additionalProperties": false,
      "properties": {
        "type": { "const": "tool_request" },
        "id": { "type": "string", "minLength": 1, "maxLength": 64 },
        "tool_calls": {
          "type": "array",
          "minItems": 1,
          "maxItems": 6,
          "items": { "$ref": "#/$defs/ToolCall" }
        }
      }
    },
    "FinalAnswer": {
      "type": "object",
      "required": ["type", "id", "answer"],
      "additionalProperties": false,
      "properties": {
        "type": { "const": "final" },
        "id": { "type": "string", "minLength": 1, "maxLength": 64 },
        "answer": { "type": "string", "minLength": 1, "maxLength": 40000 }
      }
    }
  }
}